set -g mouse on

# The "=" refers to the pane in which the most recent mouse event occurred; keys are sent without
# changing pane focus.  Send the keys three times to get three-line scrolling.  If in alternate
# screen, send scroll up/down characters rather than mouse characters.  This allows us to use less
# properly.
bind -n WheelUpPane if -Ft= \
    "#{alternate_on}" \
    "send-keys -t= ^y ^y ^y" \
    "copy-mode -et=; send-keys -Mt=; send-keys -Mt=; send-keys -Mt="
bind -n WheelDownPane if -Ft= \
    "#{alternate_on}" \
    "send-keys -t= ^e ^e ^e" \
    "copy-mode -et=; send-keys -Mt=; send-keys -Mt=; send-keys -Mt="

# Send page-up through when in alternate screen mode.  Otherwise, enter copy mode and then re-send
# so that it causes scroll-back.  Make sure that we exit copy mode when we reach the bottom (using
# -e flag).
bind -n PPage if -F "#{alternate_on}" "send-keys PPage" "copy-mode -e; send-keys PPage"
bind -n NPage if -F "#{alternate_on}" "send-keys NPage" "copy-mode -e; send-keys NPage"

# In copy mode, scroll as normal.
bind -t vi-copy PPage page-up
bind -t vi-copy NPage page-down
